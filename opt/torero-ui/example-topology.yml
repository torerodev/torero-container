---
name: torero-dashboard-demo

mgmt:
  network: torero-demo
  ipv4-subnet: 198.18.1.0/24

topology:
  nodes:
    torero-host:
      kind: linux
      image: ghcr.io/torerodev/torero-container:latest
      mgmt-ipv4: 198.18.1.10
      ports:
        - "8000:8000"  # torero-api
        - "8001:8001"  # torero-ui dashboard
        - "8080:8080"  # torero-mcp
      env:
        ENABLE_SSH_ADMIN: "true"
        ENABLE_API: "true"
        ENABLE_MCP: "true"
        ENABLE_UI: "true"     # new: enable dashboard
        UI_PORT: "8001"       # dashboard port
        DASHBOARD_REFRESH_INTERVAL: "15"  # faster refresh for demo
      binds:
        - $PWD/data:/home/admin/data
      exec:
        # import hello-torero services for testing
        - "runuser -u admin -- torero db import --repository https://github.com/torerodev/hello-torero.git import.yml"
        # optional: run some automations to populate dashboard
        - "sleep 10 && runuser -u admin -- torero service run hello-python"
        - "sleep 5 && runuser -u admin -- torero service run hello-ansible"
        - "sleep 5 && runuser -u admin -- torero service run hello-opentofu"